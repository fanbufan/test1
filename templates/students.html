<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>学生信息</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
<div class="shadow hide"></div>
<div class="model_addStudent hide">
    <h3>添加学生</h3>
    <p><span>学生姓名：</span><input id="add_name" class="name" type="text" value=""/></p>
    <p>
        <span>所属班级：</span>
        <select id="add_class_id">
            {% for item in class_list %}
                <option value="{{ item.cid }}">{{ item.title }}</option>
            {% endfor %}
        </select>
    </p>
    <p>
        <input id="add_comfirm" type="button" value="确定">
        <input class="cancel" type="button" value="取消">
    </p>
    <p class="msg_model">{{ msg }}</p>
</div>
<h1>学生信息</h1>
<p><a href="/add_student/">添加学生</a></p>
<p><a id="add_student" href="">添加学生-对话框</a></p>
<table border="1px solid black">
    <thead>
    <tr>
        <th>ID</th>
        <th>学生姓名</th>
        <th>所属班级</th>
        <th>操作</th>
    </tr>
    </thead>
    <tbody>
    {% for item in students_list %}
        <tr>
            <td>{{ item.sid }}</td>
            <td>{{ item.name }}</td>
            <td>{{ item.title }}</td>
            <td>
                <a href="/edit_student/?sid={{ item.sid }}">编辑</a>
                |
                <a href="/del_student/?sid={{ item.sid }}">删除</a>
            </td>
        </tr>
    {% endfor %}
    </tbody>
</table>
<script src="/static/js/jquery-3.5.1.min.js"></script>
<script>
    $('.cancel').click(function () {
        $('.shadow').addClass('hide');
        $('.model_addStudent').addClass('hide');
        $('#add_name').val('');
        }
    )

    $('#add_comfirm').click(function () {
        if ($('#add_name').val().length > 0){
            $.ajax({
               url: '/model_add_student/',
               type: 'POST',
               data: {'name': $('#add_name').val(), 'class_id': $('#add_class_id').val()},
               success: function(args){
                   console.log(args);
                   args = JSON.parse(args);
                   if (args.status){
                       location.reload();
                   }else {
                       $('.model_addStudent .msg_model').text(args.e);
                   }
               }
            });
        }else{
            $('.model_addStudent .msg_model').text('班级不能为空');
        }
    })

    $('#add_student').click(function () {
        $('.shadow').removeClass('hide');
        $('.model_addStudent').removeClass('hide');
        return false;
    })
</script>
</body>
</html>